# Sway config

set $mod Mod1

# Font
font pango:JetBrainsMono Nerd Font 10

# Minimal borders
default_border pixel 2
default_floating_border pixel 2

# Gaps
gaps inner 0
gaps outer 0
smart_gaps on

# Use Mouse+$mod to drag floating windows
floating_modifier $mod normal

# Terminal
bindsym $mod+Return exec ghostty

# Kill focused window
bindsym $mod+Shift+q kill

# Launcher (fuzzel)
bindsym $mod+d exec fuzzel

# Change focus (vim keys)
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Change focus (arrow keys)
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# Move focused window (vim keys)
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# Move focused window (arrow keys)
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Split orientation
bindsym $mod+z split h
bindsym $mod+v split v

# Fullscreen
bindsym $mod+f fullscreen toggle

# Layout
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Toggle floating
bindsym $mod+Shift+space floating toggle

# Focus parent
bindsym $mod+a focus parent

# Workspaces
bindsym $mod+1 exec sh -c 'swaymsg "workspace 1" && (swaymsg "[app_id=brave-browser] focus" 2>/dev/null || brave-browser)'
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# Move to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# Reload config
bindsym $mod+Shift+c reload

# Power menu
bindsym $mod+Shift+p exec ~/.local/scripts/sway-power-menu

# Exit sway (deprecated - use power menu instead)
# bindsym $mod+Shift+e exec swaynag -t warning -m 'Exit sway?' -b 'Yes' 'swaymsg exit'

# Resize mode
mode "resize" {
    bindsym h resize shrink width 10 px
    bindsym j resize grow height 10 px
    bindsym k resize shrink height 10 px
    bindsym l resize grow width 10 px

    bindsym Left resize shrink width 10 px
    bindsym Down resize grow height 10 px
    bindsym Up resize shrink height 10 px
    bindsym Right resize grow width 10 px

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

# Status bar
exec waybar

# Background
output * bg #1e1e2e solid_color

# Output configuration - let kanshi handle dynamic output management
output DP-1 mode 3440x1440@99.982Hz position 0,0

# Autostart
exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway
exec nm-applet
exec kanshi
exec swaync
exec ghostty --class=scratchpad-term

# Idle configuration
exec_always pkill swayidle; exec swayidle -w \
    timeout 300 'swaylock -f -c 000000' \
    timeout 600 'swaymsg "output * dpms off"' \
    resume 'swaymsg "output * dpms on"' \
    before-sleep 'swaylock -f -c 000000'

# OSD bar (wob) for volume/brightness feedback
set $wob_sock $XDG_RUNTIME_DIR/wob.sock
exec rm -f $wob_sock && mkfifo $wob_sock && tail -f $wob_sock | wob

# Volume keys
bindsym XF86AudioRaiseVolume exec sh -c 'pactl set-sink-volume @DEFAULT_SINK@ +5% && pactl get-sink-volume @DEFAULT_SINK@ | grep -oP "\d+(?=%)" | head -1 > $XDG_RUNTIME_DIR/wob.sock'
bindsym XF86AudioLowerVolume exec sh -c 'pactl set-sink-volume @DEFAULT_SINK@ -5% && pactl get-sink-volume @DEFAULT_SINK@ | grep -oP "\d+(?=%)" | head -1 > $XDG_RUNTIME_DIR/wob.sock'
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle

# Brightness keys
bindsym XF86MonBrightnessUp exec sh -c 'brightnessctl set +2% && brightnessctl -m | cut -d, -f4 | tr -d "%" > $XDG_RUNTIME_DIR/wob.sock'
bindsym XF86MonBrightnessDown exec sh -c 'brightnessctl set 2%- && brightnessctl -m | cut -d, -f4 | tr -d "%" > $XDG_RUNTIME_DIR/wob.sock'

# Screenshot (grim + slurp)
bindsym $mod+Shift+s exec grim -g "$(slurp)" - | tee ~/.screenshots/$(date +%Y%m%d-%H%M%S).png | wl-copy

# Lock screen
bindsym $mod+Shift+period exec swaylock -f -c 000000

# Move workspace to output
bindsym $mod+m move workspace to output left

# Scratchpad
bindsym $mod+Shift+minus move scratchpad
bindsym $mod+minus scratchpad show

# Assign Brave to workspace 1
assign [app_id="brave-browser"] workspace 1

# Dropdown terminal
bindsym $mod+grave [app_id="scratchpad-term"] scratchpad show
for_window [app_id="scratchpad-term"] {
    move scratchpad
    resize set 80ppt 80ppt
    border pixel 3
}

# Input config (uncomment and adjust as needed)
# input type:keyboard {
#     xkb_layout us
# }
