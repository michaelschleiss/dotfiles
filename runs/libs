#!/usr/bin/env bash
set -euo pipefail
source "$(dirname "$0")/lib"

# --- helpers ---

install() {
  case "$(uname -s)" in
    Darwin) brew install -q "$1" ;;
    Linux)  sudo apt-get install -qq -y "${2:-$1}" ;;
  esac
}

# --- main ---

install ripgrep
install fd fd-find
install fzf
install bat

# On Ubuntu, bat binary is called 'batcat' - create symlink
if [[ "$(uname -s)" == "Linux" ]] && command -v batcat &>/dev/null && ! command -v bat &>/dev/null; then
  mkdir -p ~/.local/bin
  ln -sf "$(which batcat)" ~/.local/bin/bat
fi

# Shell integration
add_block_to_file "$HOME/.zsh_profile" "fzf" '[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh'
