#!/usr/bin/env bash
set -euo pipefail
source "$(dirname "$0")/lib"

PROFILE="$HOME/.zsh_profile"
touch "$PROFILE"

# Secrets (API keys, tokens - file must be created manually)
add_block_to_file "$PROFILE" "secrets" '# API keys, tokens (chmod 600 ~/.secrets)
[[ -f ~/.secrets ]] && source ~/.secrets'

# PATH (core - needed by all other scripts)
add_block_to_file "$PROFILE" "path" 'export PATH="$HOME/.local/bin:$HOME/.local/scripts:$PATH"'

# General aliases
read -r -d '' ALIASES << 'EOF' || true
alias rsync="rsync -ahr --partial --partial-dir=/tmp/.rsync-partial --info=progress2 --no-inc-recursive -e 'ssh -T -o Compression=no' -c"
alias cat='bat --paging=never'
EOF
add_block_to_file "$PROFILE" "aliases" "$ALIASES"

# direnv hook
add_block_to_file "$PROFILE" "direnv" 'eval "$(direnv hook zsh)"'
